(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-c0d2"],{UdD4:function(e,t,o){},VYzt:function(e,t,o){"use strict";o.r(t);var n=o("GQeE"),s=o.n(n),i=o("EJiy"),r=o.n(i),a=o("HWK0"),c=o("lYLF"),l=o("k48p"),u={extends:a.default,data:function(){return{myPermissions:null}},props:{flowid:{type:String},flowname:{type:String}},methods:{showexport:function(){return this.myPermissions.some(function(e){return e.allow.some(function(e){return"export"==e})})},exportData:function(){var e=this;this.showexport()?this.$confirm("确定导出数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$refs.generateForm.getData().then(function(t){e.search.form=t;var o=e.getpostdata();o.flowid=e.flowid,Object(c.d)(o).then(function(t){if(console.log(t),t.data&&t.data.constructor==ArrayBuffer){var o=new Blob([t.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n=URL.createObjectURL(o),s=document.createElement("a");document.body.appendChild(s),s.setAttribute("style","display:none"),s.setAttribute("href",n),s.setAttribute("download",e.flowname),s.click(),URL.revokeObjectURL(n)}else e.$message.error(t.data.msg)})}).catch(function(e){console.log(e),console.log("有需求信息没有填写")})}).catch(function(){}):this.$message.error("您没有导出的权限")},watchTable:function(e,t){var o=this.CopyObject(e._formset);o.model=e._formset.type+"_"+e._formset.key,o.options.table_edit=!1,o.options.table_add=!1,o.options.table_delete=!1,o.options.disabled=!0;var n={config:{labelWidth:160,labelPosition:"top"},list:[o]},s={};s[e._formset.type+"_"+e._formset.key]=t[e.name],console.log(n),console.log(s),this.$refs.watchform.set_a_table("查看表格",n,s)},button_show_watch:function(e){return!0},checkUserHasPermission:function(e,t,o){for(var n=0;n<t.length;n++){var s=t[n];if(s.allow.some(function(e){return e==o})&&s.admindept.some(function(t){return"1"==t||e.some(function(e){return e==t})}))return!0}return!1},button_show_revoke:function(e){return!1},button_show_cancel:function(e){return!e.isCancel&&e.CancelNum?this.checkUserHasPermission(e.dept_id_list,this.myPermissions,"cancel"):0!=e.unFinishNum&&this.checkUserHasPermission(e.dept_id_list,this.myPermissions,"cancel")},button_click_watch:function(e){this.$refs.flowdetail.loadmodal(e._id.$oid,"查看 "+e.name+" 明细")},cancelSuccess:function(){this.search_submit()},revokeSuccess:function(){this.search_submit()},button_click_revoke:function(e){this.checkUserHasPermission(e.dept_id_list,this.myPermissions,"revoke")||this.$message.error("您没有操作撤回的权限")},button_click_cancel:function(e){this.checkUserHasPermission(e.dept_id_list,this.myPermissions,"cancel")?this.$refs.cancelflow.loadCancelView(e._id.$oid):this.$message.error("您没有操作取消的权限")},filterfun_formdata_type:function(e,t){for(var o=this,n=function(n){var i=o.pageset.display_list[n];if(t!=i.name)return"continue";if(s()(i._formset.options).indexOf("options")>=0&&0==i._formset.options.remote){var r=[];return(e[t]&&e[t].constructor==Array?e[t]:[e[t]]).forEach(function(e){for(var t=!1,o=0;o<i._formset.options.options.length;o++){var n=i._formset.options.options[o];if(e==n.value){t=!0,i._formset.options.showLabel?r.push(n.label?n.label:n.value):r.push(n.value);break}}t||r.push(e)}),r.length?{v:r.join(",")}:{v:""}}switch(i._formset.type){case"custom":if(-1!=["chose-depts","chose-users"].indexOf(i._formset.options.componentName)&&e[t]&&e[t].constructor==Array)return{v:e[t].map(function(e){return e.name}).join(",")}}},i=0;i<this.pageset.display_list.length;i++){var a=n(i);switch(a){case"continue":continue;default:if("object"===(void 0===a?"undefined":r()(a)))return a.v}}return e[t]},filterfun_to_flowstatus:function(e,t){return e.isCancel?"已取消":0==e[t]?"已结束"+(e.CancelNum?"(取消"+e.CancelNum+"次)":""):"未结束("+e[t]+")"},filterfun_int_to_datetime:function(e,t,o){try{return this.funtool_timetrans(e[t].$date.$numberLong/1e3)}catch(e){return console.log(e),null}},filterfun_to_friendlytimejs:function(e,t,o){try{return Object(l.a)(this.funtool_timetrans(e[t].$date.$numberLong/1e3),new Date)}catch(e){return console.log(e),null}},funtool_timetrans:function(e){return(e=new Date(1e3*e)).getFullYear()+"-"+((e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-")+((e.getDate()<10?"0"+e.getDate():e.getDate())+" ")+((e.getHours()<10?"0"+e.getHours():e.getHours())+":")+((e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":")+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())},search_submit:function(){var e=this;this.searchloading=!0,this.searchinfo={type:"default",info:"加载中"},this.$refs.generateForm.getData().then(function(t){e.search.form=t;var o=e.getpostdata();o.flowid=e.flowid,Object(c.c)(o).then(function(t){var o=t.data;e.searchloading=!1,e.AfterSearch(o),console.log(o),o.success&&(e.myPermissions=o.data.pagedata.permissions)})}).catch(function(e){console.log(e),console.log("有需求信息没有填写")})}}},f=o("fHYj"),h=o("cCY5"),d=o.n(h),m=(o("VCwm"),{name:"FlowAdmin",components:{searchFormCommon:u,Treeselect:d.a},data:function(){return{show:!1,flowid:null,error:null,flowname:null,choseAdminShow:!1,pageset:null,searchdefault:null,LEAF_PRIORITY:"LEAF_PRIORITY",nowchoseflowid:null,CatTreeList:null,normalizer:function(e){return{id:e.id,label:e.name,children:e.lists}}}},mounted:function(){var e=this;this.flowid=this.$route.params.id,console.log(this.$route.params.id),Object(c.b)({flowid:this.flowid}).then(function(t){var o=t.data;e.loading=!1,o.success?(e.flowname=o.data.flowname,e.pageset=o.data.pageset,e.searchdefault=o.data.default):(e.$message.error(o.msg),e.error=o.msg)})},methods:{changetoOther:function(){this.nowchoseflowid?(this.choseAdminShow=!1,this.$router.push({name:"flowadmin",params:{id:this.nowchoseflowid}})):this.$message.error("还未选择流程")},changeAdmin:function(){var e=this;this.CatTreeList?this.choseAdminShow=!0:Object(f.e)({}).then(function(t){var o=t.data;e.searchloading=!1,o.success?(e.CatTreeList=o.data,e.choseAdminShow=!0):e.$message.error(o.msg)}).catch(function(t){console.log("error",t),e.$message.error(t.message)})}}}),p=(o("rVco"),o("KHd+")),g=Object(p.a)(m,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticStyle:{margin:"10px"}},[o("el-dialog",{attrs:{title:"提示",visible:e.choseAdminShow,width:"40%"},on:{"update:visible":function(t){e.choseAdminShow=t}}},[o("treeselect",{staticStyle:{"line-height":"35px"},attrs:{"disable-branch-nodes":!0,"value-consists-of":e.LEAF_PRIORITY,multiple:!1,options:e.CatTreeList,placeholder:"请输入要切换的流程名称",normalizer:e.normalizer},model:{value:e.nowchoseflowid,callback:function(t){e.nowchoseflowid=t},expression:"nowchoseflowid"}}),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.choseAdminShow=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.changetoOther}},[e._v("切 换")])],1)],1),e._v(" "),e.error?o("el-alert",{attrs:{closable:!1,title:e.error,type:"error"}}):o("div",[o("h3",{staticStyle:{margin:"10px"}},[e._v("管理流程 ~"+e._s(e.flowname)+"  "),o("a",{on:{click:e.changeAdmin}},[e._v("切换")])]),e._v(" "),e.pageset?o("search-form-common",{attrs:{flowname:e.flowname,flowid:e.flowid,"page-set":e.pageset,default:e.searchdefault}}):e._e()],1)],1)},[],!1,null,null,null);g.options.__file="FlowAdmin.vue";t.default=g.exports},rVco:function(e,t,o){"use strict";var n=o("UdD4");o.n(n).a}}]);